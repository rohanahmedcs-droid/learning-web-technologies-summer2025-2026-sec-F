<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Believe - Login</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    .auth-wrap { max-width:420px; margin:28px auto; padding:18px; background:#fff; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.06); }
    .auth-wrap input { width:100%; padding:10px; margin-bottom:10px; border-radius:6px; border:1px solid #ccc; }
    .auth-wrap label { display:block; margin-bottom:6px; }
    .auth-actions { display:flex; gap:8px; }
    /* Popup */
    .popup-container{ display:none; position:fixed; left:0; top:0; height:100%; width:100%; background: rgba(0,0,0,0.6); }
    .popup-box{ background:white; width:320px; padding:20px; border-radius:8px; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); }
    .close{ float:right; font-size:22px; cursor:pointer; color:red; }
  </style>
</head>
<body>
  <header class="top-bar"><h1 class="brand">Believe</h1></header>

  <main>
    <section class="auth-wrap">
      <h2>Login</h2>
      <form id="login-form">
        <label>Email</label>
        <input type="email" id="login-email" required>
        <label>Password</label>
        <input type="password" id="login-password" required> <br>

        <div class="auth-actions">
          <button class="btn" type="submit">Login (demo)</button>
          <button id="openPopup" type="button" class="btn" style="background:#eee;color:#222;">Sign Up</button>
        </div>
        <p style="margin-top:12px">
  <a href="#" id="forgot-link" style="color:#1656a2;text-decoration:underline;">Forgot password?</a>
</p>

      </form>
      <p style="margin-top:12px;color:#666;">Demo accounts are stored in your browser's localStorage. Backend auth will be added later.</p>
    </section>

    <div id="popup" class="popup-container">
      <div class="popup-box">
        <span id="closePopup" class="close">&times;</span>
        <h2>Sign Up</h2>
        <form id="signup-form">
            <label>First name :</label>
          <input type="text" id="signup-name" placeholder="Your name" required><br>
          <label> Last name :</label>
          <input type="text" id="signup-lname" placeholder="last nama" required><br>
          <label> Email    :</label>
          <input type="email" id="signup-email" placeholder="Email" required><br>
          <input type="password" id="signup-password" placeholder="Password (min 8 chars)" required><br>
          <select id="signup-role">
            <option value="donor">Donor</option>
            <option value="ngo">NGO</option>
          </select><br><br>
          <button class="btn" type="submit">Create Account</button>
        </form>
      </div>
    </div>
  </main>


<!-- Forgot Password Popup -->
<div id="forgotPopup" class="popup-container">
  <div class="popup-box">
    <span id="closeForgot" class="close">&times;</span>
    <h2>Reset Password</h2>

    <form id="forgot-form-step1">
      <input type="email" id="fp-email" placeholder="Enter your registered email" required><br>
      <button class="btn" type="submit">Send Verification Code</button>
    </form>

    <form id="forgot-form-step2" style="display:none;">
      <input type="text" id="fp-code" placeholder="Enter 6-digit code"><br>
      <button class="btn" type="submit">Verify Code</button>
    </form>

    <form id="forgot-form-step3" style="display:none;">
      <input type="password" id="fp-new" placeholder="New Password (min 8 chars)"><br>
      <button class="btn" type="submit">Update Password</button>
    </form>
  </div>
</div>


  <script>
    // Popup logic
    const openBtn = document.getElementById('openPopup');
    const popUp = document.getElementById('popup');
    const closeBtn = document.getElementById('closePopup');

    openBtn.onclick = () => popUp.style.display = 'block';
    closeBtn.onclick = () => popUp.style.display = 'none';
    window.onclick = function(e){ if(e.target == popUp) popUp.style.display = 'none'; }

    // Signup (store demo user in localStorage)
    document.getElementById('signup-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const name = document.getElementById('signup-name').value.trim();
      const email = document.getElementById('signup-email').value.trim();
      const pw = document.getElementById('signup-password').value;
      const role = document.getElementById('signup-role').value;
      if (pw.length < 8) return alert('Password must be at least 8 characters (demo rule).');
      const users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
      if (users.some(u => u.email === email)) return alert('Email already used (demo).');
      users.push({ name, email, password: pw, role });
      localStorage.setItem('demoUsers', JSON.stringify(users));
      alert('Account created (demo). You can now login.');
      popUp.style.display = 'none';
    });

    // Login (demo)
    document.getElementById('login-form').addEventListener('submit', (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const pw = document.getElementById('login-password').value;
      const users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
      const user = users.find(u => u.email === email && u.password === pw);
      if (!user) return alert('Email or password does not match (demo).');
      // store session (demo)
      localStorage.setItem('demoSession', JSON.stringify({ email: user.email, name: user.name, role: user.role }));
      alert('Login successful (demo). Redirecting to appropriate dashboard...');
      if (user.role === 'ngo') location.href = 'ngo.html';
      else location.href = 'donor.html';
    });

    // ---------------- Forgot Password Logic ----------------
const forgotLink = document.getElementById('forgot-link');
const forgotPopup = document.getElementById('forgotPopup');
const closeForgot = document.getElementById('closeForgot');

const step1 = document.getElementById('forgot-form-step1');
const step2 = document.getElementById('forgot-form-step2');
const step3 = document.getElementById('forgot-form-step3');

let resetEmail = null;
let verificationCode = null;

forgotLink.onclick = function(){
  forgotPopup.style.display = 'block';
}

closeForgot.onclick = function(){
  forgotPopup.style.display = 'none';
  step1.style.display = 'block';
  step2.style.display = 'none';
  step3.style.display = 'none';
}

// Step 1 — send code (demo)
step1.addEventListener('submit', function(e){
  e.preventDefault();
  const email = document.getElementById('fp-email').value.trim();
  const users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
  const user = users.find(u => u.email === email);
  if(!user) return alert('No account found with this email (demo).');
  resetEmail = email;

  // Generate demo code
  verificationCode = Math.floor(100000 + Math.random()*900000).toString();
  alert('Demo verification code (for testing): ' + verificationCode);

  step1.style.display = 'none';
  step2.style.display = 'block';
});

// Step 2 — verify code (demo)
step2.addEventListener('submit', function(e){
  e.preventDefault();
  const code = document.getElementById('fp-code').value.trim();
  if(code !== verificationCode) return alert('Incorrect code.');
  step2.style.display = 'none';
  step3.style.display = 'block';
});

// Step 3 — update password (demo)
step3.addEventListener('submit', function(e){
  e.preventDefault();
  const newPw = document.getElementById('fp-new').value;
  if(newPw.length < 8) return alert('Password must be at least 8 characters.');

  let users = JSON.parse(localStorage.getItem('demoUsers') || '[]');
  users = users.map(u => {
    if(u.email === resetEmail) return { ...u, password:newPw };
    return u;
  });
  localStorage.setItem('demoUsers', JSON.stringify(users));

  alert('Password updated successfully (demo). You can now login.');
  forgotPopup.style.display = 'none';

  step1.style.display = 'block';
  step2.style.display = 'none';
  step3.style.display = 'none';
});

  </script>
</body>
</html>
